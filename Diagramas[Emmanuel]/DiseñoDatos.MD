# Dise帽o de datos

![Diagrama de dise帽o de datos](./UML.png)

## ndice
* ### [Clases de usuario](#clases-de-usuario-1)
    * [Usuario](#usuario)
    * [Miembro](#miembro)
    * [Alumno](#alumno)
    * [Docente](#docente)
    * [Administrativo](#administrativo)
* ### [ServidorWeb](#servidor-web-1)
* ### [Chatbot](#chatbot-1)
* ### [Prompt](#prompt-1)
* ### [Respuesta](#respuesta-1)
* ### [Conversacion](#conversacion-1)

## <label id="clases-de-usuario-1">Clases de usuario</label>
Este conjunto de clases hace referencia a los distintos tipos de usuarios presentes en la estructura del proyecto.

### <label id="usuario">Usuario</label>
---
Esta clase hace referencia a un usuario que no se ha autenticado.

#### <label id="userid">**ID**</label>
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

Identificador del usuario.

#### **Conversaciones**
| Tipo de dato |
| --- |
| [Conversacion[]](#conversacion-1) |

*Descripci贸n*

Lista de las conversaciones que el usuario ha realizado.

#### **FechaRegistro**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

Tiempo del registro de la cuenta en formato [Unix timestamp](https://en.wikipedia.org/wiki/Unix_time).

#### **UltimaActividad**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

Hora de la ultima actividad de la cuenta en formato [Unix timestamp](https://en.wikipedia.org/wiki/Unix_time).

#### **preguntar()**
Funci贸n que 

#### **iniciarSesion()**
Funci贸n que redirecciona al usuario a la pagina de login de Microsoft para proseguir con el proceso de autenticaci贸n.

### <label id="miembro">Miembro</label>
---
Clase principal de los usuarios que estan autenticados, de la cual derivan las dem谩s.

#### **Nombre**
|Tipo de dato|
|---|
| String |

*Descripci贸n*\
Nombre completo de las personas autenticadas.

#### **Correo**
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

Correo del miembro.

*Ejemplo*
| Valor |
|---|
| A20200000@alumnos.uady.mx |

#### **Facultad**
| Tipo de dato |
|---|
| String |

*Descripci贸n*\
Facultad de procedencia del usuario autenticado.

*Ejemplos*
| Valor |
|---|
| Facultad de matem谩ticas |
| Facultad de medicina |
| Facultad de derecho |

#### **FechaDeInicio**
| Tipo de dato |
|---|
| Int |

*Descripci贸n*

Fecha de inicio de las labores o curso escolar dentro de la instituci贸n en formato [Unix timestamp](https://en.wikipedia.org/wiki/Unix_time).

*Ejemplos*
| Valor | Representaci贸n |
| --- | --- |
| 1723593600 | martes, 13 de agosto de 2024 18:00:00 GMT-06:00 |

#### **TokensActivos**
| Tipo de dato |
| --- |
| String[] |

*Descripci贸n*

Una lista de los tokens generados luego de realizar el proceso de [OAuth de Microsoft](https://learn.microsoft.com/es-es/entra/architecture/auth-oauth2), se utiliza para comprobar la identidad del usuario y apartir de ello acceder a informaci贸n protegida.

*Ejemplo*
| Valor |
|---|
| abcde12345 |

### <label id="alumno">Alumno</label>
---
#### **SemestreEnCurso**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El n煤mero del semestre que actualmente cursa el alumno.

*Ejemplos*
| Valor | Representaci贸n |
| --- | --- |
| 6 | 6to semestre |

#### **Matricula**
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

La matricula del alumno, es otra forma de identificar al usuario, especificamente a los alumnos.

*Ejemplo*
| Valor |
|---|
| A20200000 |

#### **Cr茅ditos**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El total de cr茅ditos que el alumno ha alcanzado hasta el momento.

*Ejemplo*

| Valor |
|---|
| 15 |

#### **obtenerCalificaciones()**
*Descripci贸n*

Funci贸n que permite obtener al alumno sus calificaciones de las materias a las que se ha inscrito en el semestre en curso.

#### **obtenerHorario()**
*Descripci贸n*

Funci贸n que permite al alumno obtener las horas, salones, y maestros de las asignaturas a las  que se ha inscrito en el semestre en curso.

#### **obtenerAsignaturas()**
*Descripci贸n*

Funci贸n que regresa las asignaturas que se cursan en el semestre en curso.

### <label id="docente">Docente</label>
---
#### **Asignaturas**
| Tipo de dato |
| --- |
| String[] |

*Descripci贸n*

Una lista de las asignaturas que el docente imparte.

*Ejemplo*
| Valor |
| --- |
| ["Calculo diferencial", "Calculo Integral"] |

#### **TituloProfesional**
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

T铆tulo de profesi贸n del docente.

#### **NumContrato**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El n煤mero de contrato del docente.

### <label id="administrativo">Administrativo</label>
---
#### **Departamento**
| Tipo de dato |
|---|
| String |

*Descripci贸n*

Departamento al que pertenece el personal administrativo.

#### **Puesto**
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

Puesto administrativo del usuario.

#### **NumContrato**
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El n煤mero de contrato del personal administrativo.

## <label id="servidor-web-1">ServidorWeb</label>
Clase que interpreta a la entidad del servidor web, la cual maneja las peticiones [HTTP](https://developer.mozilla.org/es/docs/Web/HTTP).

### IP
| Tipo de dato |
|---|
| String |

*Descripci贸n*

La IP que va a usar el servidor.

### Port
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El puerto en el que el servidor web va a funcionar.

### Dominio
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

Dominio a utilizar para el servidor.

### get()
*Descripci贸n*

Funci贸n que maneja las peticiones [`GET`](https://developer.mozilla.org/es/docs/Web/HTTP/Methods/GET) del protocolo HTTP.

### validarToken()
*Descripci贸n*

Funci贸n que valida el token del [OAuth de Microsoft](https://learn.microsoft.com/es-es/entra/architecture/auth-oauth2), si determina que es correcto entonces env铆a una cookie con el token de autenticaci贸n para el login del usuario.

### post()
*Descripci贸n*

Funci贸n que maneja las peticiones [`POST`](https://developer.mozilla.org/es/docs/Web/HTTP/Methods/POST) del protocolo HTTP, principalmente para recibir los prompts de los usuarios y redireccionarlas a la clase del [chatBot](#chatBot).

## <label id="chatbot-1">Chatbot</label>
Clase que maneja todo lo relacionado con la l贸gica del chatbot.

### Status
| Tipo de dato |
|---|
| Int |

*Descripci贸n*

La disponibilidad del chatbot en el instante.

*Ejemplos*
| Valor | Representaci贸n |
| --- | --- |
| 0 | Ok |
| 1 | Sobresaturado |
| 2 | En mantenimiento |


### Lenguajes
| Tipo de dato |
| --- |
| String[] |

*Descripci贸n*

Array que contiene los lenguajes admitidos por el chatbot.

*Ejemplo*
| Valor |
| --- |
| [ Espa帽ol, Ingl茅s, Maya ] |

### conexionesActivas
| Tipo de dato |
| --- |
| Int[] |

*Descripci贸n*

Lista que guarda todas los [ID](#userid) de los usuarios que utilizan el servicio en el momento.

### <label id="procesarLenguaje">procesarLenguaje()</label>
*Descripci贸n*

Recibe el prompt del usuario y lo analiza, determina en que lenguaje est谩 escrito y qu茅 es lo que requiere.

### <label id="obtenerContexto">obtenerContexto()</label>
*Descripci贸n*

Las conversaciones anteriores que se han tenido con el bot se analizan para obtener el contexto de las partes m谩s importantes y con ello generar una respuesta m谩s precisa.

### consultarSICEI()
*Descripci贸n*

Funci贸n que se encarga de hacer las peticiones a la base datos del [SICEI](https://www.sicei.uady.mx/).

### generarRespuesta()
*Descripci贸n*

Con los datos analizados en las funciones [procesarLenguaje()](#procesarLenguaje) y [obtenerContexto()](#obtenerContexto) genera una respuesta que se env铆a de vuelta al [servidor web](#ServidorWeb) y posterior a ello se envia la respuesta al usuario.

### ponerEnCola()
*Descripci贸n*

Determina si la petici贸n no puede ser procesada en este momento y manda la orden de poner en cola al usuario.

## <label id="prompt-1">Prompt</label>
Clase que guarda la informaci贸n relacionada al prompt que un usuario escribe para recibir la respuesta del chatbot.
###  ID
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

Identificador de la respuesta.

### Contenido
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

El texto que el usuario ha introducido.

### Lenguaje
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

El lenguaje del texto que el usuario introdujo.

### Inapropiado
| Tipo de dato |
| --- |
| Bool |

*Descripci贸n*

Determina si la petici贸n del usuario contiene alg煤n contenido inapropiado para el chatbot.
## <label id="respuesta-1">Respuesta</label>
Clase que almacena el contenido y los metadatos de las respuestas generadas por el chatbot.

### ID
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

Identificador de la respuesta.

### Resultados
| Tipo de dato |
| --- |
| String[] |

*Descripci贸n*

Una lista con todas las respuestas en formato texto generados por el chatbot.

### Rating
| Tipo de dato |
| --- |
| Int[] |

*Descripci贸n*

Lista con la puntuaci贸n que el usuario ha otorgado a una respuesta en especifico.

*Ejemplos*
| Valor | Representaci贸n |
| --- | --- |
| -2 | Respuesta no satisfactoria |
| 0 | Puntuaci贸n no otorgada |
| 2 | Respuesta satisfactoria |

### Lenguaje
| Tipo de dato |
| --- |
| String |

*Descripci贸n*

El lenguaje en el cual el texto fue generado.

## <label id="conversacion-1">Conversacion</label>
Clase que almacena los [prompts](#prompt-1) y [respuestas](#respuesta-1) que se han llevado acabo durante una conversaci贸n, adem谩s de incluir sus metadatos.

### ID
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El identificador de la conversaci贸n.

### Prompts
| Tipo de dato |
| --- |
| [Prompt[]](#prompt-1) |

*Descripci贸n*

Lista con todos los prompts hechos por el [usuario](#usuario) durante la conversaci贸n.

### Historial
| Tipo de dato |
| --- |
| [Respuesta[]](#respuesta-1) |

*Descripci贸n*

Lista con todas las respuestas generadas por el chatbot durante la conversaci贸n.

### Autor
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

El [id](#userid) del usuario autor de la conversaci贸n.

### UltimaInteraccion
| Tipo de dato |
| --- |
| Int |

*Descripci贸n*

La hora de la 煤ltima interacci贸n en esa conversaci贸n en formato [Unix timestamp](https://en.wikipedia.org/wiki/Unix_time).